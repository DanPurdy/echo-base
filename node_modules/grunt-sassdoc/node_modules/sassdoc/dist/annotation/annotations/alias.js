"use strict";

var _core = require("6to5-runtime/core-js");

module.exports = alias;
function alias(env) {
  return {
    name: "alias",

    parse: function parse(text) {
      return text.trim();
    },

    resolve: function resolve(data) {
      data.forEach(function (item) {
        if (item.alias === undefined) {
          return;
        }

        var alias = item.alias;
        var name = item.context.name;

        var aliasedItem = _core.Array.find(data, function (i) {
          return i.context.name === alias;
        });

        if (aliasedItem === undefined) {
          env.logger.warn("Item `" + name + "` is an alias of `" + alias + "` but this item doesn't exist.");
          delete item.alias;
          return;
        }

        if (!Array.isArray(aliasedItem.aliased)) {
          aliasedItem.aliased = [];
        }

        aliasedItem.aliased.push(name);
      });
    },

    allowedOn: ["function", "mixin", "variable"],

    multiple: false };
}